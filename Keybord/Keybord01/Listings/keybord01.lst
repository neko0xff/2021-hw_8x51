C51 COMPILER V9.60.0.0   KEYBORD01                                                         01/09/2022 19:32:59 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE KEYBORD01
OBJECT MODULE PLACED IN .\Objects\keybord01.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE keybord01.C OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\keybord01.lst) TABS(2) OBJECT(.\Objects\keybord01.obj)

line level    source

   1          /*--------------------------------------------------------------------------------------*/
   2          /*程式檔名：keypad.c                  */
   3          /*                      */
   4          /*                      */
   5          /*本程式可控制 4x4 矩陣式鍵盤的輸入並將其顯示於七段顯示器上       */
   6          /*--------------------------------------------------------------------------------------*/
   7          #include "io51.h"
   8                             
   9          char  seg7[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
  10                    0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71};/* 0 ~ F 的顯示碼 */
  11                        
  12          char  keys[]={0xee,0xde,0xbe,0x7e,0xed,0xdd,0xbd,0x7d,
  13                          0xeb,0xdb,0xbb,0x7b,0xe7,0xd7,0xb7,0x77};/* 按鍵 0 ~ F 的按鍵碼 */
  14                        
  15          char  key=0,key_code,i,test_code=0xf0,n1=0,n2=4,n3=8,n4=12;
  16          
  17          void  show_key(char scan_signal,char n);
  18          
  19          void main(){
  20   1        P1=0x40;        /*┐同時點亮 4 顆七段顯示器的 'g' 節段  */
  21   1        P2=0x0f;        /*┘          */
  22   1        while (key==0)        /* key = = 0 繼續執行, 反之結束   */
  23   1        {
  24   2          P3=test_code;     /* 經由 P3 送出測試信號 0xf0    */
  25   2          key_code=P3;      /* 經由 P3 讀取按鍵碼       */
  26   2          if (key_code!=0xf0)   /* 如果有按鍵按下時, 即 key_code!=0xf0  */
  27   2          {
  28   3              key_code=P3;    /* 再次的經由 P3 讀取按鍵碼     */
  29   3            if (key_code!=0xf0) /* 如果有按鍵按下時, 即 key_code!=0xf0  */
  30   3              {
  31   4                show_key(0xfe,n1);/*┐開始逐一掃描, 以判斷    */
  32   4                show_key(0xfd,n2);/*│是那一鍵按下          */
  33   4                show_key(0xfb,n3);/*│          */
  34   4                show_key(0xf7,n4);/*┘          */ 
  35   4              }
  36   3          }                           
  37   2        }
  38   1      }
  39          void show_key(char scan_signal,char n)
  40          {
  41   1        P3=scan_signal;       /* 經由 P3 送出測試信號     */
  42   1        key_code=P3;        /* 經由 P3 讀取按鍵碼       */
  43   1        for (i=n;i<n+4;i++)
  44   1        {
  45   2          if (key_code==keys[i])    /* 找出按鍵碼相對應的七段顯示碼   */
  46   2          {
  47   3              P1=seg7[i];   /* 將七段顯示碼顯示於七段顯示器上 */
  48   3                break;
  49   3            }
  50   2        }
  51   1      }
  52          


C51 COMPILER V9.60.0.0   KEYBORD01                                                         01/09/2022 19:32:59 PAGE 2   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    144    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     40    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
